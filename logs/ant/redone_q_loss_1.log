

-------------------------------------------------------

 Environment: AntBulletEnv-v0

-------------------------------------------------------




-----------------------------------------------------------------------------------------------------
 Agent Model Exists, loading: subrepos/rl-trained-agents/sac/AntBulletEnv-v0_1/AntBulletEnv-v0.zip
-----------------------------------------------------------------------------------------------------


pybullet build time: Oct 11 2021 20:52:37
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.


-----------------------------------------------------------------------------------------------------
 Training Coach Model from scrach
-----------------------------------------------------------------------------------------------------


coach settings = {
    "force_retrain": False, 
    "learning_rate": 0.0001, 
    "hidden_sizes": [64, 64, 64, 64, ], 
    "loss_function": "value_prediction_loss", 
    "consistent_coach_loss": {"scale_future_state_loss": 1, }, 
    "delayed_coach_loss": {"epochs_of_delay": 50, }, 
    "value_plus_state_loss": {"value_proportion": 0.5, }, 
    "number_of_episodes": 100, 
    "number_of_epochs": 120, 
    "train_test_split": 0.7, 
    "batch_size": 1024, 
    "with_card": True, 
}
Starting Train/Test
    Epoch: 0
    Epoch: 1
    Epoch: 2
    Epoch: 3
    Epoch: 4
    Epoch: 5
    Epoch: 6
    Epoch: 7
    Epoch: 8
    Epoch: 9
    Epoch: 10
    Epoch: 11
    Epoch: 12
    Epoch: 13
    Epoch: 14
    Epoch: 15
    Epoch: 16
    Epoch: 17
    Epoch: 18
    Epoch: 19
    Epoch: 20
    Epoch: 21
    Epoch: 22
    Epoch: 23
    Epoch: 24
    Epoch: 25
    Epoch: 26
    Epoch: 27
    Epoch: 28
    Epoch: 29
    Epoch: 30
    Epoch: 31
    Epoch: 32
    Epoch: 33
    Epoch: 34
    Epoch: 35
    Epoch: 36
    Epoch: 37
    Epoch: 38
    Epoch: 39
    Epoch: 40
    Epoch: 41
    Epoch: 42
    Epoch: 43
    Epoch: 44
    Epoch: 45
    Epoch: 46
    Epoch: 47
    Epoch: 48
    Epoch: 49
    Epoch: 50
    Epoch: 51
    Epoch: 52
    Epoch: 53
    Epoch: 54
    Epoch: 55
    Epoch: 56
    Epoch: 57
    Epoch: 58
    Epoch: 59
    Epoch: 60
    Epoch: 61
    Epoch: 62
    Epoch: 63
    Epoch: 64
    Epoch: 65
    Epoch: 66
    Epoch: 67
    Epoch: 68
    Epoch: 69
    Epoch: 70
    Epoch: 71
    Epoch: 72
    Epoch: 73
    Epoch: 74
    Epoch: 75
    Epoch: 76
    Epoch: 77
    Epoch: 78
    Epoch: 79
    Epoch: 80
    Epoch: 81
    Epoch: 82
    Epoch: 83
    Epoch: 84
    Epoch: 85
    Epoch: 86
    Epoch: 87
    Epoch: 88
    Epoch: 89
    Epoch: 90
    Epoch: 91
    Epoch: 92
    Epoch: 93
    Epoch: 94
    Epoch: 95
    Epoch: 96
    Epoch: 97
    Epoch: 98
    Epoch: 99
    Epoch: 100
    Epoch: 101
    Epoch: 102
    Epoch: 103
    Epoch: 104
    Epoch: 105
    Epoch: 106
    Epoch: 107
    Epoch: 108
    Epoch: 109
    Epoch: 110
    Epoch: 111
    Epoch: 112
    Epoch: 113
    Epoch: 114
    Epoch: 115
    Epoch: 116
    Epoch: 117
    Epoch: 118
    Epoch: 119
Saving Coach to: models.ignore/coach/AntBulletEnv-v0/redone_q_loss_1/


-----------------------------------------------------------------------------------------------------
 Testing Agent+Coach
-----------------------------------------------------------------------------------------------------


test settings = {
    "force_recompute": False, 
    "graph_smoothing": 0, 
    "number_of_episodes_for_baseline": 30, 
    "number_of_epochs_for_optimal_parameters": 15, 
    "number_of_episodes_for_testing": 10, 
    "initial_epsilon": 0.1316872427983539, 
    "initial_horizon": 8, 
    "reward_discount": 0.98, 
    "acceptable_performance_loss": 2, 
    "confidence_interval_for_convergence": 90, 
    "min_reward_single_timestep": 19, 
    "max_reward_single_timestep": 105, 
    "horizons": {0: 1, 0.0007: 4, 0.0015: 16, 0.002: 26, }, 
}
baseline = {
    "max": 105.15090233798715, 
    "min": 97.48693352007322, 
    "range": 7.663968817913926, 
    "count": 30, 
    "sum": 3048.2638920231598, 
    "average": 101.608796400772, 
    "stdev": 1.7865210698736294, 
    "median": 101.56097791518405, 
}
/home/jeffhykin/repos/AFRL/.venv/lib/python3.8/site-packages/gym/spaces/box.py:73: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(
Traceback (most recent call last):
  File "./main/run/full.py", line 50, in <module>
    full_run(
  File "./main/run/full.py", line 26, in full_run
    results = Tester.smart_load(
  File "/home/jeffhykin/repos/AFRL/main/test_prediction.py", line 673, in smart_load
    return Tester(
  File "/home/jeffhykin/repos/AFRL/main/test_prediction.py", line 412, in run_all_episodes
    optimal_epsilon, optimal_horizon = self.gather_optimal_parameters(baseline)
  File "/home/jeffhykin/repos/AFRL/.venv/lib/python3.8/site-packages/cool_cache/__init__.py", line 73, in wrapper
    result = input_func(*args, **kwargs)
  File "/home/jeffhykin/repos/AFRL/main/test_prediction.py", line 128, in gather_optimal_parameters
    baseline_min, baseline_max = confidence_interval(confidence_interval_percent, baseline_samples)
NameError: name 'confidence_interval' is not defined

[silver_spectacle] There were unviewed results
[silver_spectacle] So the display server is still running at: http://localhost:9900
[silver_spectacle] (use the stop server button to kill it now)

